<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sign-Up</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"></script>
    <style>
      body {
        margin: 0;
      }

      .nav-space {
        margin: 0 20px;
      }
      .nav-item:hover {
        background-color: #96c7c1;
        color: black;
      }
      .content {
        display: flex;
        flex: 1;
        align-items: center;
        justify-content: center;
        height: 400px;
        width: 100vw;
        /* background-color: darkseagreen; */
        margin: 20px;
      }
      .task-div {
        display: flex;
        flex-direction: column;
        background-color: powderblue;
        height: 400px;
        width: 400px;
        margin: 10px;
      }
      .form-item {
        margin: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      form p {
        margin: 0;
        color: red;
      }
      input {
        width: 200px;
        height: 35px;
        margin: 10px;
      }
      button {
        border: 1px solid gray;
        background-color: white;
        border-radius: 2px;
        margin: 20px 10px;
        width: 100px;
      }
      button:hover {
        border-color: darkblue;
        color: darkblue;
      }
      .btn-div {
        display: flex;
        align-items: center;
        justify-content: flex-start;
      }
    </style>
  </head>
  <body>
    <nav
      class="navbar navbar-expand-sm bg-dark container-fluid navbar-dark center"
    >
      <ul class="navbar-nav">
        <li class="nav-item nav-space">
          <a href="./taskindex.html" class="nav-link">Home</a>
        </li>
        <li class="nav-item nav-space">
          <a href="#" class="nav-link">Sign_up</a>
        </li>
        <li class="nav-item nav-space">
          <a href="./tasklogin.html" class="nav-link">Login</a>
        </li>
      </ul>
    </nav>
    <div class="content">
      <div class="task-div">
        <form id="form" class="form-item">
          <input
            type="text"
            class="form-control"
            id="fn"
            placeholder="First Name"
            required
          />
          <p id="fname_error" style="visibility: hidden">First Name Required</p>
          <input
            type="text"
            class="form-control"
            id="ln"
            placeholder="Last Name"
            required
          />
          <p id="lname_error" style="visibility: hidden">Last Name Required</p>
          <input
            type="email"
            class="form-control"
            id="email"
            placeholder="Email ID"
            required
          />
          <p id="email_error" style="visibility: hidden">Mail ID Required</p>
          <input
            type="password"
            class="form-control"
            id="pwd"
            placeholder="Password"
            required
          />
          <p id="pwd_error" style="visibility: hidden">Password Required</p>
          <div class="btn-div">
            <button type="reset" class="btn-primary" id="reset-btn">
              Reset
            </button>
            <button type="button" class="btn-primary" id="sign-btn">
              Sign-Up
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      let reset = document.getElementById("reset-btn");
      let signup = document.getElementById("sign-btn");

      let fn = document.getElementById("fn");
      let ln = document.getElementById("ln");
      let mail = document.getElementById("email");
      let pword = document.getElementById("pwd");

      fn.addEventListener("blur", valid_fname);
      ln.addEventListener("blur", valid_lname);
      mail.addEventListener("blur", valid_email);
      pword.addEventListener("blur", valid_pwd);

      signup.addEventListener("click", signupfun, true);

      function signupfun() {
        let fname = document.getElementById("fn").value;
        let lname = document.getElementById("ln").value;
        let email = document.getElementById("email").value;
        let pwd = document.getElementById("pwd").value;

        if (fname == "") {
          alert("Enter First Name");
          document.getElementById("fn").focus();
          return false;
        }
        if (lname == "") {
          alert("Enter Last Name");
          document.getElementById("ln").focus();
          return false;
        }
        if (email == "") {
          alert("Enter Email ID");
          document.getElementById("email").focus();
          return false;
        }
        if (pwd == "") {
          alert("Enter Password");
          document.getElementById("pwd").focus();
          return false;
        }

        let config = {
          method: "POST",
          body: JSON.stringify({
            email: email,
            password: pwd,
            firstName: fname,
            lastName: lname,
          }),
          headers: {
            "Content-type": "application/json",
          },
        };

        fetch(
          "https://task-management-rest-app.herokuapp.com/api/users",
          config
        )
          .then((res) => res.json())
          .then((data) => {
            console.log(data);
            location.replace("./tasklogin.html");
            document.getElementById("form").reset();
          })
          .catch((e) => console.log(e.message));

        document.getElementById("form").reset();
      }

      function valid_fname() {
        if (fn.value == "") {
          fn.classList.add("is-invalid");
          document.getElementById("fname_error").style.visibility = "visible";
        } else {
          fn.classList.add("is-valid");
          fn.classList.remove("is-invalid");
          document.getElementById("fname_error").style.visibility = "hidden";
        }
      }
      function valid_lname() {
        if (ln.value == "") {
          ln.classList.add("is-invalid");
          document.getElementById("lname_error").style.visibility = "visible";
        } else {
          ln.classList.add("is-valid");
          ln.classList.remove("is-invalid");
          document.getElementById("lname_error").style.visibility = "hidden";
        }
      }
      function valid_email() {
        if (mail.value == "") {
          mail.classList.add("is-invalid");
          document.getElementById("email_error").style.visibility = "visible";
        } else {
          mail.classList.add("is-valid");
          mail.classList.remove("is-invalid");
          document.getElementById("email_error").style.visibility = "hidden";
        }
      }
      function valid_pwd() {
        if (pword.value == "") {
          pword.classList.add("is-invalid");
          document.getElementById("pwd_error").style.visibility = "visible";
        } else {
          pword.classList.add("is-valid");
          pword.classList.remove("is-invalid");
          document.getElementById("pwd_error").style.visibility = "hidden";
        }
      }
    </script>
  </body>
</html>
